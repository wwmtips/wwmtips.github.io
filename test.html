<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì—°ìš´: í•œêµ­ ìœ„í‚¤</title>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5SMVDZTDST"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-5SMVDZTDST');
    </script>

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="apple-touch-icon" sizes="57x57" href="fav/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="fav/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="fav/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="fav/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="fav/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="fav/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="fav/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="fav/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="fav/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="fav/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="fav/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="fav/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="fav/favicon-16x16.png">
    <link rel="manifest" href="fav/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="fav/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { primary: '#3182f6', bgMain: '#f2f4f6' }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f2f4f6; color: #191f28; -webkit-tap-highlight-color: transparent; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .snap-x-mandatory { scroll-snap-type: x mandatory; }
        .snap-start { scroll-snap-align: start; }
        
        /* [ì¤‘ìš”] timer.js í˜¸í™˜ì„±ì„ ìœ„í•œ ìœ í‹¸ë¦¬í‹° */
        .show { display: block !important; } /* ë°”í…€ì‹œíŠ¸ ê°•ì œ í‘œì‹œ */
        
        /* ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™” ìŠ¤íƒ€ì¼ */
        .nav-item.active { @apply text-gray-900; }
        .nav-item.active svg { @apply stroke-gray-900 stroke-2; }

        /* ì¬ìƒ ì¤‘ ì œëª© íë¥´ëŠ” íš¨ê³¼ */
@keyframes marquee {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
}
.animate-marquee {
    display: inline-block;
    padding-left: 100%;
    animation: marquee 10s linear infinite;
}

/* ëŠë¦° íšŒì „ (ì•„ì´ì½˜ìš©) */
.animate-spin-slow {
    animation: spin 8s linear infinite;
}
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° */
.no-scrollbar::-webkit-scrollbar {
    display: none;
}
.no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
}
/* ============================================================
   â˜… ê²€ìƒ‰ ê²°ê³¼ì°½ ë””ìì¸ ë³µêµ¬ (Tailwind ë¯¸ì‘ë™ ëŒ€ë¹„ ê°•ì œ ì ìš©)
   ============================================================ */

/* 1. ê²°ê³¼ì°½ ì „ì²´ ì»¨í…Œì´ë„ˆ */
#global-search-results {
    background-color: #ffffff !important;
    border-radius: 1rem !important; /* 16px */
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25) !important;
    border: 1px solid #f1f1f1 !important;
    overflow: hidden !important;
}

/* 2. ê²°ê³¼ ë¦¬ìŠ¤íŠ¸ í•­ëª© ê³µí†µ */
.search-result-item {
    display: flex !important;
    flex-direction: column !important;
    padding: 1rem !important; /* 16px */
    border-bottom: 1px solid #f9f9f9 !important;
    cursor: pointer !important;
    transition: background-color 0.2s !important;
}

.search-result-item:hover {
    background-color: #f8fafc !important; /* ì—°í•œ íšŒìƒ‰ */
}

.search-result-item:last-child {
    border-bottom: none !important;
}

/* 3. ìœ í˜•ë³„ ë±ƒì§€ ìŠ¤íƒ€ì¼ */
.search-badge {
    display: inline-block !important;
    font-size: 10px !important;
    font-weight: 900 !important;
    padding: 2px 6px !important;
    border-radius: 4px !important;
    margin-bottom: 6px !important;
    width: fit-content !important;
}

/* ë±ƒì§€ ìƒ‰ìƒ ê°•ì œ ì§€ì • */
.badge-quest   { background-color: #eff6ff !important; color: #2563eb !important; } /* íŒŒë‘ (ë¬´ë¦¼ë¡) */
.badge-chunji  { background-color: #f5f3ff !important; color: #7c3aed !important; } /* ë³´ë¼ (ì²œì§€ë¡) */
.badge-quiz    { background-color: #fffbeb !important; color: #d97706 !important; } /* ë…¸ë‘ (ì¡±ë³´) */

/* 4. ì œëª© ë° ì„¤ëª… */
.search-item-title {
    font-size: 15px !important;
    font-weight: 700 !important;
    color: #1e293b !important;
    line-height: 1.2 !important;
}

.search-item-desc {
    font-size: 11px !important;
    color: #94a3b8 !important;
    margin-top: 4px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
}
/* [ë””ìì¸ ë³µêµ¬] ê²€ìƒ‰ ê²°ê³¼ì°½ ë° ì¹´ë“œ ìŠ¤íƒ€ì¼ */

/* 1. ê²°ê³¼ì°½ ì „ì²´ ì»¨í…Œì´ë„ˆ */
#global-search-results {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    margin-top: 8px;
    background: #ffffff;
    border-radius: 16px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    border: 1px solid #f1f5f9;
    z-index: 1000;
    overflow: hidden;
    max-height: 400px;
    overflow-y: auto;
}

/* 2. ê° ê²€ìƒ‰ ê²°ê³¼ í•­ëª© (ì¹´ë“œ) */
.search-result-item {
    display: flex !important;
    flex-direction: column !important;
    padding: 14px 16px !important;
    border-bottom: 1px solid #f8fafc !important;
    cursor: pointer !important;
    transition: background-color 0.2s ease;
    position: relative;
}

.search-result-item:last-child {
    border-bottom: none !important;
}

.search-result-item:hover {
    background-color: #f8fafc !important; /* í˜¸ë²„ ì‹œ ì—°í•œ íšŒìƒ‰ */
}

/* ì˜¤ë¥¸ìª½ í™”ì‚´í‘œ ì•„ì´ì½˜ ì¶”ê°€ (CSS ê°€ìƒ ìš”ì†Œ) */
.search-result-item::after {
    content: 'â€º';
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 18px;
    color: #cbd5e1;
}

/* 3. ë±ƒì§€ ìŠ¤íƒ€ì¼ (ì •ë³´, ì²œì§€ë¡, ì¡±ë³´, í€˜ìŠ¤íŠ¸) */
.badge {
    display: inline-block !important;
    font-size: 10px !important;
    font-weight: 800 !important;
    padding: 2px 6px !important;
    border-radius: 4px !important;
    margin-bottom: 6px !important;
    width: fit-content !important;
    letter-spacing: -0.02em;
}

/* ì¹´í…Œê³ ë¦¬ë³„ ìƒ‰ìƒ ê°•ì œ ì§€ì • */
.badge.info { background-color: #f1f5f9 !important; color: #64748b !important; } /* ì •ë³´ - íšŒìƒ‰ */
.badge.item { background-color: #eff6ff !important; color: #2563eb !important; } /* ì²œì§€ë¡/í€˜ìŠ¤íŠ¸ - íŒŒë‘ */
.badge.quiz { background-color: #fffbeb !important; color: #d97706 !important; } /* ì¡±ë³´ - ê³¨ë“œ */

/* 4. ê²°ê³¼ í…ìŠ¤íŠ¸ (ì œëª©) */
.result-text {
    font-size: 14px !important;
    font-weight: 700 !important;
    color: #1e293b !important;
    line-height: 1.4 !important;
    width: 90%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis; /* ë„ˆë¬´ ê¸¸ë©´ ë§ì¤„ì„í‘œ */
}

/* ê²°ê³¼ ì—†ìŒ ìŠ¤íƒ€ì¼ */
.no-result {
    padding: 30px 20px !important;
    font-size: 13px !important;
    font-weight: 600 !important;
    color: #94a3b8 !important;
    background: #ffffff !important;
}

/* ìŠ¤í¬ë¡¤ë°” ë””ìì¸ (ê¹”ë”í•˜ê²Œ) */
#global-search-results::-webkit-scrollbar {
    width: 4px;
}
#global-search-results::-webkit-scrollbar-thumb {
    background: #e2e8f0;
    border-radius: 10px;
}
    </style>
</head>

<body class="pb-24">

    <script src="hw.js"></script>
    <script src="script_test.js"></script>
    <script src="timer.js"></script>

    <div id="sidebar-overlay" onclick="closeSidebar()"
        class="fixed inset-0 bg-black/40 z-[2999] hidden backdrop-blur-sm transition-opacity"></div>

    <header
        class="sticky top-0 z-50 bg-white h-[60px] lg:h-[72px] flex items-center px-5 lg:px-8 gap-4 border-b border-gray-100 transition-all duration-300 shadow-sm">

        <div class="hidden lg:block font-black text-xl text-blue-600 cursor-pointer flex-none"
            onclick="switchTab('home')">ì—°ìš´ìœ„í‚¤</div>

        <div class="flex-1 mx-4 lg:mx-10 relative">
            <div
                class="bg-gray-100 rounded-xl h-11 flex items-center px-4 text-gray-500 focus-within:bg-white focus-within:ring-2 focus-within:ring-blue-100 transition-all border border-transparent focus-within:border-blue-200">
                <svg class="w-5 h-5 flex-none" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>

                <input type="text" id="header-search-input" placeholder="í†µí•© ê²€ìƒ‰" oninput="handleGlobalSearch(event)"
                    class="bg-transparent border-none w-full h-full ml-3 outline-none text-gray-800 text-sm font-bold placeholder-gray-400"
                    autocomplete="off">

                <button id="search-clear-btn" class="hidden text-gray-400 hover:text-gray-600 ml-2"
                    onclick="document.getElementById('header-search-input').value=''; this.style.display='none'; document.getElementById('global-search-results').style.display='none';">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                        </path>
                    </svg>
                </button>
            </div>

            <div id="global-search-results"
                class="hidden absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl shadow-2xl border border-gray-100 z-[100] overflow-hidden animate-in fade-in slide-in-from-top-2">
            </div>
        </div>

        <nav class="hidden lg:flex items-center gap-6 text-sm font-bold text-gray-500 ml-auto">
            <button onclick="switchTab('home')" id="pc-nav-home"
                class="hover:text-blue-600 transition-colors nav-item active">í™ˆ</button>
            <button onclick="switchTab('quest')" id="pc-nav-quest"
                class="hover:text-blue-600 transition-colors nav-item">ë¬´ë¦¼ë¡</button>
            <button onclick="switchTab('chunji')" id="pc-nav-chunji"
                class="hover:text-blue-600 transition-colors nav-item">ì²œì§€ë¡</button>
            <button onclick="switchTab('todo')" id="pc-nav-todo"
                class="hover:text-blue-600 transition-colors nav-item">í•  ì¼</button>
            <button onclick="switchTab('quiz')" id="pc-nav-quiz"
                class="hover:text-blue-600 transition-colors nav-item">ìŠ¤ë¬´ê³ ê°œ</button>
        </nav>

        <button onclick="toggleSidebar()"
            class="w-10 h-10 lg:w-12 lg:h-12 flex items-center justify-center text-gray-800 cursor-pointer hover:bg-gray-50 rounded-full transition-colors flex-none">
            <svg class="w-7 h-7 lg:w-8 lg:h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>

        <div id="global-search-results"
            class="hidden absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl shadow-2xl border border-gray-100 z-[100] overflow-hidden animate-in fade-in slide-in-from-top-2">
        </div>
    </header>

    <aside id="main-sidebar"
        class="fixed top-0 right-[-100%] w-full max-w-[320px] h-full bg-white z-[3000] flex flex-col transition-[right] duration-300 ease-in-out shadow-2xl">
        <div class="p-5 border-b border-gray-100 relative bg-white">
            <div class=" relative bg-white">
                <div class="flex items-center justify-between mb-4">
                    <span class="text-[11px] font-black text-gray-400 uppercase tracking-widest">ì—°ìš´ìœ„í‚¤</span>
                    <button
                        class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-900 transition-colors"
                        onclick="closeSidebar()">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <div class="relative">
                    <div onclick="togglePlaylist()"
                        class="flex items-center justify-between bg-gray-50 hover:bg-gray-100 p-3 rounded-xl border border-gray-100 cursor-pointer transition-all active:scale-[0.98] group">
                        <div class="flex items-center gap-3 overflow-hidden">
                            <div id="player-icon"
                                class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white flex-none shadow-sm shadow-blue-100 transition-transform">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z">
                                    </path>
                                </svg>
                            </div>
                            <div class="flex flex-col overflow-hidden">
                                <div class="overflow-hidden whitespace-nowrap">
                                    <span id="player-title" class="inline-block text-xs font-bold text-gray-800">ê³¡ ëª©ë¡ì„
                                        ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
                                </div>
                                <span class="text-[10px] text-gray-400 mt-0.5">ì—°ìš´ìœ„í‚¤ OST</span>
                            </div>
                        </div>
                        <button id="audio-toggle-btn" onclick="handlePlayPause(event)"
                            class="w-8 h-8 flex items-center justify-center bg-white rounded-full shadow-sm text-blue-600 hover:scale-110 transition-transform flex-none ml-2">
                            â–¶
                        </button>
                    </div>

                    <div id="playlist-dropdown"
                        class="hidden absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl shadow-2xl border border-gray-100 z-[70] overflow-hidden animate-in fade-in slide-in-from-top-2">
                        <div class="bg-gray-50 px-4 py-2 border-b border-gray-100 flex justify-between items-center">
                            <span id="playlist-status" class="text-[10px] font-bold text-gray-400">0 / 0</span>
                            <span class="w-1.5 h-1.5 rounded-full bg-blue-500 animate-pulse"></span>
                        </div>
                        <ul id="playlist-items" class="max-h-[220px] overflow-y-auto no-scrollbar">
                        </ul>
                    </div>
                </div>

                <audio id="main-audio" preload="auto"></audio>
            </div>
        </div>
        <div class="flex-1 overflow-y-auto p-5">
            <div class="mb-8">
                <div class="text-xs font-bold text-gray-400 mb-3">ë°”ë¡œê°€ê¸°</div>
                <div class="space-y-4">
                    <div class="flex items-center gap-3 text-[16px] font-bold text-gray-800 cursor-pointer"
                        onclick="switchTab('home'); closeSidebar();">í™ˆ
                    </div>
                    <div class="flex items-center gap-3 text-[16px] font-bold text-gray-800 cursor-pointer"
                        onclick="switchTab('todo'); closeSidebar();">ì˜¤ëŠ˜ì˜
                        í•  ì¼</div>
                    <div class="flex items-center gap-3 text-[16px] font-bold text-gray-800 cursor-pointer"
                        onclick="switchTab('quest'); closeSidebar();">ë¬´ë¦¼ë¡</div>
                    <div class="flex items-center gap-3 text-[16px] font-bold text-gray-800 cursor-pointer"
                        onclick="switchTab('chunji'); closeSidebar();">ì²œì§€ë¡</div>
                    <div class="flex items-center gap-3 text-[16px] font-bold text-gray-800 cursor-pointer"
                        onclick="switchTab('quiz'); closeSidebar();">ìŠ¤ë¬´ê³ ê°œ
                        ì¡±ë³´</div>
                </div>
            </div>

            <div class="mb-8">
                <div class="text-xs font-bold text-gray-400 mb-3">ë„ê°</div>
                <div class="space-y-4">
                    <div class="flex items-center gap-3 text-[16px] font-bold text-gray-800 cursor-pointer"
                        onclick="openGuideDirect('harts.html'); closeSidebar();">ì‹¬ë²• ë„ê°</div>
                    <div class="flex items-center gap-3 text-[16px] font-bold text-gray-800 cursor-pointer"
                        onclick="openGuideDirect('marts.html'); closeSidebar();">ë¹„ê²° ë„ê°</div>
                </div>
            </div>
        </div>
    </aside>
    <main id="main-content" class="mx-auto lg:max-w-screen-xl lg:px-6 transition-all duration-300">
        <div id="view-home" class="pb-10 lg:pb-20">

            <div class="w-full lg:max-w-screen-xl lg:mx-auto lg:px-4 lg:pt-8 lg:space-y-6">

                <section
                    class="relative w-full aspect-[18/10] lg:aspect-auto lg:h-[380px] lg:rounded-2xl bg-gray-200 mb-5 lg:mb-0 overflow-hidden shadow-sm group">
                    <div class="w-full h-full relative">
                        <div id="hero-slider-track" class="flex h-full transition-transform duration-500 ease-in-out">
                        </div>
                        <div id="slider-indicators" class="absolute bottom-4 w-full flex justify-center gap-1.5 z-10">
                        </div>
                        <button onclick="moveSlide(-1)"
                            class="hidden lg:group-hover:flex absolute left-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-black/30 hover:bg-black/50 backdrop-blur-sm text-white rounded-full items-center justify-center transition-all">â€¹</button>
                        <button onclick="moveSlide(1)"
                            class="hidden lg:group-hover:flex absolute right-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-black/30 hover:bg-black/50 backdrop-blur-sm text-white rounded-full items-center justify-center transition-all">â€º</button>
                    </div>
                </section>

                <div class="lg:grid lg:grid-cols-2 lg:gap-6">

                    <section
                        class="bg-white p-5 mb-3 lg:mb-0 lg:rounded-2xl lg:border lg:border-gray-200 lg:shadow-sm w-full lg:col-span-full">
                        <div class="mb-4">
                            <h3 class="text-[19px] font-extrabold text-gray-900">ê¸°ë³¸ ê°€ì´ë“œ</h3>
                        </div>
                        <div class="relative">
                            <div id="guide-scroll-wrapper"
                                class="flex overflow-x-auto gap-3 pb-4 snap-x snap-mandatory no-scrollbar lg:grid lg:grid-cols-6 lg:gap-4 lg:pb-0">

                                <a onclick="openGuideDirect('newb.html')"
                                    class="flex-none w-[23%] snap-start flex flex-col items-center gap-2 cursor-pointer active:scale-95 transition lg:w-auto lg:py-4">
                                    <div
                                        class="w-12 h-12 lg:w-16 lg:h-16 bg-orange-50 rounded-2xl flex items-center justify-center text-2xl lg:text-3xl border border-orange-100/50">
                                        ğŸ“œ</div>
                                    <span
                                        class="text-[11px] lg:text-[13px] font-bold text-gray-600 text-center whitespace-nowrap">ê°•í˜¸ì…ë¬¸ì„œ</span>
                                </a>

                                <a onclick="openGuideDirect('guide/up.html')"
                                    class="flex-none w-[23%] snap-start flex flex-col items-center gap-2 cursor-pointer active:scale-95 transition lg:w-auto lg:py-4">
                                    <div
                                        class="w-12 h-12 lg:w-16 lg:h-16 bg-red-50 rounded-2xl flex items-center justify-center text-2xl lg:text-3xl border border-red-100/50">
                                        ğŸ“ˆ</div>
                                    <span
                                        class="text-[11px] lg:text-[13px] font-bold text-gray-600 text-center whitespace-nowrap">ìœ¡ì„±ê°€ì´ë“œ</span>
                                </a>

                                <a onclick="openGuideDirect('moon.html')"
                                    class="flex-none w-[23%] snap-start flex flex-col items-center gap-2 cursor-pointer active:scale-95 transition lg:w-auto lg:py-4">
                                    <div
                                        class="w-12 h-12 lg:w-16 lg:h-16 bg-gray-100 rounded-2xl flex items-center justify-center text-2xl lg:text-3xl border border-gray-200/50">
                                        ğŸ›ï¸</div>
                                    <span
                                        class="text-[11px] lg:text-[13px] font-bold text-gray-600 text-center whitespace-nowrap">ë¬¸íŒŒì…ë¬¸</span>
                                </a>

                                <a onclick="openGuideDirect('guide/weapon.html')"
                                    class="flex-none w-[23%] snap-start flex flex-col items-center gap-2 cursor-pointer active:scale-95 transition lg:w-auto lg:py-4">
                                    <div
                                        class="w-12 h-12 lg:w-16 lg:h-16 bg-blue-50 rounded-2xl flex items-center justify-center text-2xl lg:text-3xl border border-blue-100/50">
                                        âš”ï¸</div>
                                    <span
                                        class="text-[11px] lg:text-[13px] font-bold text-gray-600 text-center whitespace-nowrap">ì¥ë¹„ë„ê°</span>
                                </a>

                                <a onclick="openGuideDirect('tier_weapon.html')"
                                    class="flex-none w-[23%] snap-start flex flex-col items-center gap-2 cursor-pointer active:scale-95 transition lg:w-auto lg:py-4">
                                    <div
                                        class="w-12 h-12 lg:w-16 lg:h-16 bg-purple-50 rounded-2xl flex items-center justify-center text-2xl lg:text-3xl border border-purple-100/50">
                                        ğŸŒ€</div>
                                    <span
                                        class="text-[11px] lg:text-[13px] font-bold text-gray-600 text-center whitespace-nowrap">ë¬´ê³µë„ê°</span>
                                </a>

                                <a onclick="openGuideDirect('majang.html')"
                                    class="flex-none w-[23%] snap-start flex flex-col items-center gap-2 cursor-pointer active:scale-95 transition lg:w-auto lg:py-4">
                                    <div
                                        class="w-12 h-12 lg:w-16 lg:h-16 bg-pink-50 rounded-2xl flex items-center justify-center text-2xl lg:text-3xl border border-pink-100/50">
                                        ğŸ€„</div>
                                    <span
                                        class="text-[11px] lg:text-[13px] font-bold text-gray-600 text-center whitespace-nowrap">ë§ˆì‘ê°€ì´ë“œ</span>
                                </a>
                            </div>

                            <div class="flex justify-center gap-1.5 mt-2 lg:hidden" id="guide-indicators">
                                <div class="w-4 h-1.5 rounded-full bg-blue-500 transition-all duration-300"></div>
                                <div class="w-1.5 h-1.5 rounded-full bg-gray-200 transition-all duration-300"></div>
                            </div>
                        </div>
                    </section>

                    <section class="bg-white p-5 mb-3 lg:mb-0 lg:rounded-2xl lg:border lg:border-gray-200 lg:shadow-sm">
                        <div class="mb-4">
                            <h3 class="text-[19px] font-extrabold text-gray-900">ë¬´ë¦¼ë¡</h3>
                        </div>
                        <div id="mansarok-list"
                            class="flex flex-col divide-y divide-gray-100 lg:divide-none lg:grid lg:grid-cols-2 lg:gap-3">
                        </div>

                        <button onclick="switchTab('quest')"
                            class="w-full py-3.5 mt-3 bg-blue-50 text-blue-600 font-bold rounded-xl text-[15px] active:scale-95 transition-all hover:bg-blue-100">
                            ì „ì²´ ë³´ê¸°
                        </button>
                    </section>

                    <section class="bg-white p-5 mb-3 lg:mb-0 lg:rounded-2xl lg:border lg:border-gray-200 lg:shadow-sm">
                        <div class="mb-4">
                            <h3 class="text-[19px] font-extrabold text-gray-900">ì²œì§€ë¡</h3>
                        </div>
                        <div id="home-chunji-list"
                            class="flex flex-col divide-y divide-gray-100 lg:divide-none lg:grid lg:grid-cols-2 lg:gap-3">
                        </div>

                        <button onclick="switchTab('chunji')"
                            class="w-full py-3.5 mt-3 bg-blue-50 text-blue-600 font-bold rounded-xl text-[15px] active:scale-95 transition-all hover:bg-blue-100">
                            ì „ì²´ ë³´ê¸°
                        </button>
                    </section>

                    <section class="bg-white p-5 mb-3 lg:mb-0 lg:rounded-2xl lg:border lg:border-gray-200 lg:shadow-sm">
                        <div class="mb-4">
                            <h3 class="text-[19px] font-extrabold text-gray-900">í•  ì¼</h3>
                        </div>
                        <div id="gangho-timer-list" class="grid grid-cols-1 gap-3">
                            <div class="text-center py-10 text-gray-400 text-sm">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                        </div>

                        <button onclick="switchTab('todo')"
                            class="w-full py-3.5 mt-3 bg-blue-50 text-blue-600 font-bold rounded-xl text-[15px] active:scale-95 transition-all hover:bg-blue-100">
                            ì „ì²´ ë³´ê¸°
                        </button>
                    </section>


                    <section class="bg-white p-5 mb-3 lg:mb-6 lg:rounded-2xl lg:border lg:border-gray-200 lg:shadow-sm w-full lg:col-span-full">
    <div class="mb-5 flex items-center justify-between">
        <h3 class="text-[19px] font-extrabold text-gray-900">
            <span class="w-1.5 h-5 bg-blue-600 inline-block rounded-full mr-2 align-middle"></span>ì„¸ê³„ íƒí—˜
        </h3>
    </div>
    
    <div id="home-map-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-3">
        </div>
</section>
                </div>
            </div>
        </div>

        <div id="view-todo" style="display: none;" class="p-5">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold text-gray-900">í•  ì¼</h2>
                <span id="server-time"
                    class="text-xs font-mono bg-white border border-gray-200 px-2 py-1 rounded text-gray-500">00:00:00</span>
            </div>
            <div id="gangho-timer-list-tab" class="grid grid-cols-1 md:grid-cols-2 gap-3"></div>
        </div>


        <div id="view-quest" style="display: none;" class="p-5">
            <div id="quest-list-view">
                <div class="flex gap-2 mb-4 overflow-x-auto no-scrollbar">
                    <select id="quest-type-select"
                        class="bg-white border border-gray-200 text-sm p-2 rounded-lg outline-none focus:border-blue-500"
                        onchange="onQuestTypeChange()">
                        <option value="all">ì „ì²´</option>
                    </select>
                    <select id="quest-location-select"
                        class="bg-white border border-gray-200 text-sm p-2 rounded-lg outline-none focus:border-blue-500"
                        onchange="applyQuestFilter()">
                        <option value="all">ì§€ì—­</option>
                    </select>
                </div>
                <div id="quest-grid-container" class="space-y-3 lg:space-y-0 lg:grid lg:grid-cols-2 lg:gap-4"></div>
                <div id="pagination-container" class="flex justify-center gap-2 mt-8 pb-10"></div>
            </div>
            <div id="quest-detail-view" style="display:none;">
                <button onclick="showQuestList()" class="mb-4 text-sm font-bold text-blue-600 flex items-center"><span
                        class="text-lg mr-1">â†</span> ëª©ë¡ìœ¼ë¡œ</button>
                <div id="quest-content-loader"
                    class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm min-h-[200px]"></div>
            </div>
        </div>

        <div id="view-chunji" style="display: none;" class="p-5">
            <div id="chunji-list-view">
                <div class="flex gap-2 mb-4">
                    <select id="chunji-type-select"
                        class="bg-white border border-gray-200 text-sm p-2 rounded-lg outline-none"
                        onchange="onChunjiTypeChange()">
                        <option value="all">ì „ì²´</option>
                    </select>
                </div>
                <div id="chunji-list-container" class="space-y-3 pb-10 lg:space-y-0 lg:grid lg:grid-cols-2 lg:gap-4">
                </div>
                <div id="chunji-pagination-container" class="flex justify-center gap-2 mt-8 pb-10"></div>
            </div>
            <div id="chunji-detail-view" style="display:none;">
                <button onclick="showChunjiList()" class="mb-4 text-sm font-bold text-blue-600 flex items-center"><span
                        class="text-lg mr-1">â†</span> ëª©ë¡ìœ¼ë¡œ</button>
                <div id="chunji-detail-content"
                    class="bg-white p-6 rounded-xl border border-gray-100 shadow-sm min-h-[200px]"></div>
            </div>
        </div>

        <div id="view-quiz" style="display: none;" class="p-5">
            <div id="quiz-counter-area" class="text-xs text-gray-500 mb-2 font-medium">ë°ì´í„° ë¡œë”© ì¤‘...</div>
            <input type="text" id="quiz-local-search"
                class="w-full bg-white border border-gray-200 p-3 rounded-xl mb-4 text-sm outline-none focus:border-blue-500 transition-colors"
                placeholder="ë‹¨ì„œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ê°€ì‹œ)">
            <div class="bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm">
                <table class="w-full text-sm text-left">
                    <tbody id="quiz-table-body"></tbody>
                </table>
            </div>
        </div>

        <div id="view-guide" style="display: none;" class="p-5">
            <div id="guide-content-loader"></div>
            <div id="guide-dynamic-content" class="bg-white rounded-xl p-5 border border-gray-100"></div>
        </div>
    </main>

    <nav
        class="lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-100 h-[60px] flex justify-between items-center px-6 z-50">
        <button id="nav-home" onclick="switchTab('home')"
            class="nav-item active flex flex-col items-center justify-center w-14 gap-1 text-gray-400">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                </path>
            </svg>
            <span class="text-[10px] font-bold">í™ˆ</span>
        </button>
        <button id="nav-quest" onclick="switchTab('quest')"
            class="nav-item flex flex-col items-center justify-center w-14 gap-1 text-gray-400">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                </path>
            </svg>
            <span class="text-[10px] font-bold">ë¬´ë¦¼ë¡</span>
        </button>
        <button id="nav-todo" onclick="switchTab('todo')"
            class="nav-item flex flex-col items-center justify-center w-14 gap-1 text-gray-400">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                </path>
            </svg>
            <span class="text-[10px] font-bold">í•  ì¼</span>
        </button>
        <button id="nav-quiz" onclick="switchTab('quiz')"
            class="nav-item flex flex-col items-center justify-center w-14 gap-1 text-gray-400">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z">
                </path>
            </svg>
            <span class="text-[10px] font-bold">ìŠ¤ë¬´ê³ ê°œ</span>
        </button>
    </nav>

    <div id="timer-sheet-modal" class="fixed inset-0 z-[9999] hidden backdrop-blur-sm transition-opacity">
        <div class="absolute inset-0 bg-black/50" onclick="closeTimerSheet()"></div>
        <div class="absolute bottom-0 w-full bg-white rounded-t-2xl p-6 shadow-2xl transition-transform duration-300">
            <div id="timer-detail-content"></div>
        </div>
    </div>

    <div id="report-sheet-modal" class="fixed inset-0 z-[9999] hidden">
        <div class="absolute inset-0 bg-black/50 transition-opacity" onclick="closeReportSheet()"></div>
        <div
            class="absolute bottom-0 w-full bg-white rounded-t-2xl p-6 transition-transform transform translate-y-full duration-300 ease-out">
            <div class="w-10 h-1 bg-gray-300 rounded-full mx-auto mb-6"></div>
            <div class="bg-gray-50 p-4 rounded-xl mb-4 text-sm text-gray-600">ì˜¤ë¥˜ ì œë³´ëŠ” ì–¸ì œë‚˜ í™˜ì˜í•©ë‹ˆë‹¤.</div>
            <button onclick="window.open('https://open.kakao.com/o/sXW3q9bg', '_blank')"
                class="w-full py-4 bg-yellow-300 rounded-xl font-bold text-gray-900">ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ì œë³´í•˜ê¸°</button>
        </div>
    </div>

    <script>
        // [1] ì‚¬ì´ë“œë°” ì œì–´
        function toggleSidebar() {
            const sb = document.getElementById('main-sidebar');
            const ol = document.getElementById('sidebar-overlay');
            if (sb && ol) { sb.style.right = '0'; ol.classList.remove('hidden'); document.body.style.overflow = 'hidden'; }
        }
        function closeSidebar() {
            const sb = document.getElementById('main-sidebar');
            const ol = document.getElementById('sidebar-overlay');
            if (sb && ol) { sb.style.right = '-100%'; ol.classList.add('hidden'); document.body.style.overflow = ''; }
        }

        // [2] íƒ­ ì „í™˜
        // [ìˆ˜ì •] íƒ­ ì „í™˜ ë° ì£¼ì†Œì°½(URL) ë™ê¸°í™” ë¡œì§
        window.switchTab = function (tabName, updateHistory = true) {
            // 1. ìš”ì²­í•˜ì‹  URL íŒŒë¼ë¯¸í„° ì´ë¦„ ë§¤í•‘ (í•  ì¼ -> hw)
            const urlMapping = {
                'home': '',
                'quest': 'quest',
                'hw': 'hw',
                'todo': 'hw', // ê¸°ì¡´ 'todo' í˜¸ì¶œ ì‹œì—ë„ 'hw'ë¡œ ì²˜ë¦¬
                'quiz': 'quiz',
                'chunji': 'chunji'
            };

            const targetParam = urlMapping[tabName] || tabName;

            // 2. í™”ë©´(View) ì „í™˜ (ê¸°ì¡´ ID êµ¬ì¡° ìœ ì§€: view-todoëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš© ê°€ëŠ¥)
            const views = ['view-home', 'view-quest', 'view-chunji', 'view-quiz', 'view-todo', 'view-guide'];
            views.forEach(v => {
                const el = document.getElementById(v);
                if (!el) return;

                // 'hw'ë¡œ ë“¤ì–´ì™€ë„ 'view-todo'ë¥¼ ë³´ì—¬ì£¼ë„ë¡ ë§¤ì¹­
                const isTarget = (v === 'view-' + tabName) || (tabName === 'hw' && v === 'view-todo');
                el.style.display = isTarget ? 'block' : 'none';
            });

            // 3. ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ í™œì„±í™” ìŠ¤íƒ€ì¼ ê°±ì‹ 
            updateNavUI(tabName === 'hw' ? 'todo' : tabName);

            // 4. ì£¼ì†Œì°½(URL) ë³€ê²½ ë¡œì§ (í•µì‹¬)
            if (updateHistory) {
                let newUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;

                // í™ˆì´ ì•„ë‹ˆë©´ ?tab=... ì¶”ê°€, í™ˆì´ë©´ íŒŒë¼ë¯¸í„° ì—†ì´ ê¹”ë”í•˜ê²Œ í‘œì‹œ
                if (targetParam && targetParam !== 'home') {
                    newUrl += '?tab=' + targetParam;
                }

                window.history.pushState({ tab: tabName }, '', newUrl);
            }

            window.scrollTo(0, 0);

            // íƒ­ ì „í™˜ ì‹œ íƒ€ì´ë¨¸/ë¦¬ìŠ¤íŠ¸ ê°±ì‹ 
            if (tabName === 'hw' || tabName === 'todo' || tabName === 'home') updateTimers();
        };

        // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìƒ‰ìƒ ë³€ê²½ ë³´ì¡° í•¨ìˆ˜
        function updateNavUI(activeTab) {
            // PC ìƒë‹¨ ë©”ë‰´
            const pcNavIds = ['pc-nav-home', 'pc-nav-quest', 'pc-nav-chunji', 'pc-nav-todo', 'pc-nav-quiz'];
            pcNavIds.forEach(id => {
                const el = document.getElementById(id);
                if (!el) return;
                const isMatch = id === 'pc-nav-' + activeTab;
                el.classList.toggle('text-blue-600', isMatch);
                el.classList.toggle('active', isMatch);
                el.classList.toggle('text-gray-500', !isMatch);
            });

            // ëª¨ë°”ì¼ í•˜ë‹¨ ë°”
            const navIds = ['nav-home', 'nav-quest', 'nav-todo', 'nav-quiz'];
            navIds.forEach(id => {
                const el = document.getElementById(id);
                if (!el) return;
                const isMatch = id === 'nav-' + activeTab;
                el.classList.toggle('active', isMatch);
                el.classList.toggle('text-gray-400', !isMatch);
            });
        }

        // ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸°/ì•ìœ¼ë¡œê°€ê¸° ë²„íŠ¼ ëŒ€ì‘
        window.onpopstate = function (event) {
            const params = new URLSearchParams(window.location.search);
            const tab = params.get('tab') || 'home';
            // ë’¤ë¡œê°€ê¸° ì‹œì—ëŠ” URLì„ ë˜ ë‹¤ì‹œ pushí•˜ì§€ ì•Šë„ë¡ false ì „ë‹¬
            switchTab(tab, false);
        };
        // [3] ìˆ™ì œ ë°ì´í„° ë° ì²´í¬ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬ (ì•ˆì „í•˜ê²Œ ë¡œì»¬ ì •ì˜)
        const LOCAL_TASK_DATA = [
            { id: 'm_1', freq: 'monthly', type: 'êµ¬ë§¤', loc: 'ê³µëª…ìƒì ', title: 'ìŒì˜ ì„ ìœ¨ êµ¬ë§¤' },
            { id: 'm_2', freq: 'monthly', type: 'êµ¬ë§¤', loc: 'ê³µëª…ìƒì ', title: 'ì„ ìœ¨ í• ì¸ê¶Œ êµ¬ë§¤' },
            { id: 'w_7', freq: 'weekly', type: 'ì „íˆ¬', loc: 'í˜‘ê²½', title: 'í˜‘ê²½ í´ë¦¬ì–´' },
            { id: 'w_8', freq: 'weekly', type: 'ì „íˆ¬', loc: 'ê²€ë¬´ì¥', title: 'ê²€ë¬´ì¥ í´ë¦¬ì–´' },
            { id: 'w_1', freq: 'weekly', type: 'êµ¬ë§¤', loc: 'ê°•í˜¸ë°±ì§„', title: 'ìŒì˜ ì„ ìœ¨ êµ¬ë§¤' },
            { id: 'w_5', freq: 'weekly', type: 'êµ¬ë§¤', loc: 'ì‹œì¦Œìƒì ', title: 'ìŒì˜ ì„ ìœ¨ êµ¬ë§¤' },
            { id: 'w_2', freq: 'weekly', type: 'êµ¬ë§¤', loc: 'ì‹œì¦Œìƒì ', title: 'ì‹¬ë²• ì‹¬ë“ ìƒì êµ¬ë§¤' },
            { id: 'w_3', freq: 'weekly', type: 'êµ¬ë§¤', loc: 'ì‹œì¦Œìƒì ', title: 'ë¹„ê²° ì§€ì› ìƒì êµ¬ë§¤' },
            { id: 'w_4', freq: 'weekly', type: 'êµ¬ë§¤', loc: 'ì‹œì¦Œìƒì ', title: 'ì‘ì€ ë‹¨ë°±ì „ ìƒì êµ¬ë§¤' },
            { id: 'w_6', freq: 'weekly', type: 'êµ¬ë§¤', loc: 'ê°•í˜¸ë ¹ ìƒì ', title: 'ë¹„ê²° ì§€ì› ìƒì êµ¬ë§¤' },
            { id: 'w_9', freq: 'weekly', type: 'í™œë™', loc: 'ë™ë§¹', title: 'í™”ë¬¼ ìš´ì†¡' },
            { id: 'w_13', freq: 'weekly', type: 'í™œë™', loc: 'ë¬´ì—­', title: 'ì‹œë§¤ì‚¬ êµí™˜' },
            { id: 'w_10', freq: 'weekly', type: 'êµ¬ë§¤', loc: 'ì‹œì¦Œìƒì ', title: 'ê¸°ìˆ  í•„ê¸° êµ¬ë§¤' },
            { id: 'w_11', freq: 'weekly', type: 'êµ¬ë§¤', loc: 'ê¸°ìˆ ì–‘ì„±', title: 'ê¸°ìˆ  ì„ íƒ ìƒì êµ¬ë§¤' },
            { id: 'w_12', freq: 'weekly', type: 'êµ¬ë§¤', loc: 'ì‹¬ë“êµí™˜', title: 'ì‹¬ë²• ì„ íƒ ìƒì êµ¬ë§¤' },
            { id: 'w_13', freq: 'weekly', type: 'êµ¬ë§¤', loc: 'ìœ íŒŒì‹œë ¨', title: 'ì‹¬ë²•/ë¹„ê²° ìƒì êµ¬ë§¤' },
            { id: 'd_2', freq: 'daily', type: 'í™œë™', loc: 'í˜„ìƒë ¹', title: 'ìˆ˜ë°°/ë³µìˆ˜ í˜„ìƒë ¹' },
            { id: 'd_4', freq: 'daily', type: 'í™œë™', loc: 'ê¿ˆì†', title: 'ì—½ë¹„íœ´ì˜ ë„ë°• ìƒê¸°íŒ' },
            { id: 'd_5', freq: 'daily', type: 'í™œë™', loc: 'í•„ë“œ', title: 'ë¹„ê²° ì¬ë£Œ ì±„ì§‘' },
            { id: 'd_6', freq: 'daily', type: 'í™œë™', loc: 'í•„ë“œ', title: 'ì•¼ìƒë§ˆ í¬íš' },
            { id: 'd_7', freq: 'daily', type: 'í™œë™', loc: 'ê³µë•ì§€', title: 'ë™ì „ ë˜ì§€ê³  ì†Œì› ë¹Œê¸°' },
            { id: 'd_3', freq: 'daily', type: 'í™œë™', loc: 'ê°•í˜¸í˜¸ë ¹', title: 'ë¬¸íŒŒ í˜¸ë ¹' }
        ];

        window.toggleTaskCheck = function (taskId) {
            const statusData = (typeof getChecklistStatus === 'function') ? getChecklistStatus() : { checked: {} };
            if (statusData.checked[taskId]) delete statusData.checked[taskId];
            else statusData.checked[taskId] = true;

            if (typeof saveChecklistStatus === 'function') saveChecklistStatus(statusData);
            else localStorage.setItem('wwm_checklist_v3', JSON.stringify(statusData)); // fallback

            updateTimers(); // í™”ë©´ ê°±ì‹ 
        };

        // [4] ë°”í…€ ì‹œíŠ¸ ì—´ê¸° (ì™„ë²½ ìˆ˜ì •)
        window.openTimerSheetByName = function (name) {
            if (typeof TIMERS === 'undefined') return;
            const timer = TIMERS.find(x => x.name === name);
            if (!timer) return;

            const modal = document.getElementById('timer-sheet-modal');
            const contentBox = document.getElementById('timer-detail-content');
            if (!modal || !contentBox) return;

            // í—¤ë” ìƒì„±
            let html = `
            <div class="text-center mb-6">
                <h3 class="text-xl font-bold text-gray-900 mb-1">${timer.name}</h3>
                <p class="text-sm text-gray-500">${timer.desc}</p>
            </div>
        `;

            // ë¦¬ìŠ¤íŠ¸ ìƒì„±
            if (timer.type === 'reset') {
                const statusData = (typeof getChecklistStatus === 'function') ? getChecklistStatus() : { checked: {} };
                // ì „ì—­ TASK_DATAê°€ ì—†ìœ¼ë©´ ë¡œì»¬ ë°ì´í„° ì‚¬ìš©
                const sourceData = (typeof TASK_DATA !== 'undefined') ? TASK_DATA : LOCAL_TASK_DATA;
                const tasks = sourceData.filter(t => t.freq === timer.freq);

                if (tasks.length > 0) {
                    html += `<div class="grid grid-cols-1 gap-3 max-h-[60vh] overflow-y-auto no-scrollbar pb-10">`;
                    tasks.forEach(task => {
                        const isChecked = statusData.checked[task.id];
                        const bgClass = isChecked ? 'bg-blue-50 border-blue-100' : 'bg-gray-50 border-gray-100';
                        const textClass = isChecked ? 'text-gray-400 line-through' : 'text-gray-800';
                        const checkIcon = isChecked ? 'âœ”' : '';

                        html += `
                        <div id="sheet-task-${task.id}" class="flex items-center justify-between p-4 rounded-xl border ${bgClass} cursor-pointer active:scale-95 transition-all" onclick="toggleSheetTask('${task.id}')">
                            <div class="flex items-center gap-3 overflow-hidden">
                                <span class="text-[11px] px-1.5 py-0.5 bg-white border border-gray-200 rounded text-gray-500 whitespace-nowrap font-bold">${task.loc}</span>
                                <span class="text-[15px] font-medium ${textClass} truncate">${task.title}</span>
                            </div>
                            <div class="task-check-icon w-6 h-6 rounded-full border border-gray-300 bg-white flex items-center justify-center text-sm text-blue-600 font-bold flex-none shadow-sm">${checkIcon}</div>
                        </div>`;
                    });
                    html += `</div>`;
                } else {
                    html += `<p class="text-center text-gray-400 py-10">ì²´í¬ë¦¬ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>`;
                }
            } else {
                html += `<div class="bg-gray-50 p-5 rounded-xl border border-gray-100 text-gray-600 leading-relaxed text-sm">${timer.desc}<br>ì‹œê°„ì— ë§ì¶° ì°¸ì—¬í•´ë³´ì„¸ìš”!</div>`;
            }

            contentBox.innerHTML = html;
            modal.classList.remove('hidden'); // Tailwind ìˆ¨ê¹€ í•´ì œ
            modal.classList.add('show');      // í˜¸í™˜ì„±ìš© í´ë˜ìŠ¤ ì¶”ê°€
        };

        // ì‹œíŠ¸ ë‚´ë¶€ ì²´í¬ í† ê¸€ (UI ì¦‰ì‹œ ê°±ì‹ )
        window.toggleSheetTask = function (taskId) {
            toggleTaskCheck(taskId); // ë°ì´í„° ì €ì¥

            // UI ì¦‰ì‹œ ë°˜ì˜
            const el = document.getElementById(`sheet-task-${taskId}`);
            if (el) {
                const statusData = (typeof getChecklistStatus === 'function') ? getChecklistStatus() : { checked: {} };
                const isChecked = statusData.checked[taskId];
                const icon = el.querySelector('.task-check-icon');
                const title = el.querySelector('span.truncate');

                if (isChecked) {
                    el.className = "flex items-center justify-between p-4 rounded-xl border bg-blue-50 border-blue-100 cursor-pointer active:scale-95 transition-all";
                    if (title) title.className = "text-[15px] font-medium text-gray-400 line-through truncate";
                    if (icon) icon.innerText = 'âœ”';
                } else {
                    el.className = "flex items-center justify-between p-4 rounded-xl border bg-gray-50 border-gray-100 cursor-pointer active:scale-95 transition-all";
                    if (title) title.className = "text-[15px] font-medium text-gray-800 truncate";
                    if (icon) icon.innerText = '';
                }
            }
        };

        // ì‹œíŠ¸ ë‹«ê¸°
        window.closeTimerSheet = function () {
            const modal = document.getElementById('timer-sheet-modal');
            if (modal) {
                modal.classList.add('hidden');
                modal.classList.remove('show');
            }
        };

        // [5] íƒ€ì´ë¨¸/í• ì¼ ë Œë”ë§ (í†µí•©)
        window.updateTimers = function () {
            if (typeof TIMERS === 'undefined') return;
            const now = new Date();
            const serverTimeEl = document.getElementById('server-time');
            if (serverTimeEl) serverTimeEl.innerText = now.toTimeString().split(' ')[0];

            const statusData = (typeof getChecklistStatus === 'function') ? getChecklistStatus() : { checked: {} };
            const sourceData = (typeof TASK_DATA !== 'undefined') ? TASK_DATA : LOCAL_TASK_DATA;

            // 1. í™ˆ í™”ë©´ (ìš”ì•½)
            const homeList = document.getElementById('gangho-timer-list');
            if (homeList && document.getElementById('view-home').style.display !== 'none') {
                let homeHtml = '';
                TIMERS.forEach(timer => {
                    let timeText = "í™•ì¸";
                    let isUrgent = false;
                    let progressHtml = "";
                    let iconClass = "bg-orange-50 text-orange-500";
                    let iconSymbol = "â°";

                    if (timer.type === 'reset') {
                        const target = getNextResetTime(timer.freq, now);
                        const diff = target - now;
                        timeText = formatDuration(diff);
                        if (diff < 3 * 60 * 60 * 1000) isUrgent = true;

                        const tasks = sourceData.filter(t => t.freq === timer.freq);
                        if (tasks.length > 0) {
                            const done = tasks.filter(t => statusData.checked[t.id]).length;
                            const isAllDone = (done === tasks.length);
                            progressHtml = `<span class="text-xs font-bold ${isAllDone ? 'text-blue-600' : 'text-gray-400'} ml-1">(${done}/${tasks.length})</span>`;
                            if (isAllDone) { iconClass = "bg-blue-50 text-blue-600"; iconSymbol = "âœ”"; }
                        }
                    } else if (timer.type === 'daily_operating') {
                        timeText = (now.getHours() >= 5 && now.getHours() < 7) ? "íœ´ì¥" : "ìš´ì˜";
                    } else if (timer.type === 'schedule') {
                        const res = calculateSchedule(timer.schedules, now);
                        timeText = res.timeStr;
                    }

                    const clockClass = isUrgent ? "text-red-500 bg-red-50" : "text-blue-500 bg-blue-50";
                    homeHtml += `
                <div class="bg-white p-4 rounded-xl border border-gray-100 flex justify-between items-center cursor-pointer active:scale-95 transition-transform shadow-sm" onclick="openTimerSheetByName('${timer.name}')">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-xl ${iconClass} flex items-center justify-center text-xl transition-colors">${iconSymbol}</div>
                        <div>
                            <div class="font-bold text-gray-800 text-[15px] flex items-center">${timer.name}${progressHtml}</div>
                            <div class="text-xs text-gray-500 mt-0.5">${timer.desc}</div>
                        </div>
                    </div>
                    <div class="text-xs font-bold px-2 py-1 rounded-md ${clockClass}">${timeText}</div>
                </div>`;
                });
                homeList.innerHTML = homeHtml;
            }

            // 2. í•  ì¼ íƒ­ (ì „ì²´)
            const todoList = document.getElementById('gangho-timer-list-tab');
            if (todoList && document.getElementById('view-todo').style.display !== 'none') {
                let todoHtml = '';
                const groups = [
                    { title: 'ğŸ“… ì¼ì¼ ì»¨í…ì¸ ', desc: 'ë§¤ì¼ 06:00 ì´ˆê¸°í™”', ids: ['daily', 'pvp_daily'] },
                    { title: 'ğŸ“… ì£¼ê°„ ì»¨í…ì¸ ', desc: 'ë§¤ì£¼ ì›”ìš”ì¼ 06:00 ì´ˆê¸°í™”', ids: ['weekly', 'fireworks_weekly'] },
                    { title: 'ğŸ“… ì›”ê°„ / ì´ë²¤íŠ¸', desc: 'ë§¤ì›” 1ì¼ 06:00 ì´ˆê¸°í™”', ids: ['monthly', 'event_winter'] }
                ];

                groups.forEach(group => {
                    let groupContent = '';
                    let groupTimeStr = '';
                    group.ids.forEach(timerId => {
                        const timer = TIMERS.find(t => t.id === timerId);
                        if (!timer) return;

                        if (timer.type === 'reset' && !groupTimeStr) {
                            const target = getNextResetTime(timer.freq, now);
                            const diff = target - now;
                            groupTimeStr = `<span class="text-blue-600 font-bold">${formatDuration(diff)}</span> ë‚¨ìŒ`;
                        }

                        if (timer.type === 'reset') {
                            const tasks = sourceData.filter(t => t.freq === timer.freq);
                            if (tasks.length > 0) {
                                groupContent += `<div class="grid grid-cols-1 md:grid-cols-2 gap-2 mt-3">`;
                                tasks.forEach(task => {
                                    const isChecked = statusData.checked[task.id];
                                    const bgClass = isChecked ? 'bg-blue-50 border-blue-100' : 'bg-gray-50 border-gray-100';
                                    const textClass = isChecked ? 'text-gray-400 line-through' : 'text-gray-800';
                                    const checkIcon = isChecked ? 'âœ”' : '';
                                    groupContent += `
                                    <div class="flex items-center justify-between p-3 rounded-xl border ${bgClass} cursor-pointer active:scale-95 transition-all" onclick="toggleTaskCheck('${task.id}', this)">
                                        <div class="flex items-center gap-2 overflow-hidden">
                                            <span class="text-[10px] px-1.5 py-0.5 bg-white border border-gray-200 rounded text-gray-500 whitespace-nowrap">${task.loc}</span>
                                            <span class="text-sm font-medium ${textClass} truncate">${task.title}</span>
                                        </div>
                                        <div class="w-5 h-5 rounded-full border border-gray-300 bg-white flex items-center justify-center text-xs text-blue-600 font-bold flex-none">${checkIcon}</div>
                                    </div>`;
                                });
                                groupContent += `</div>`;
                            }
                        } else {
                            let statusText = "í™•ì¸";
                            let statusClass = "bg-gray-100 text-gray-500";
                            if (timer.type === 'daily_operating') {
                                statusText = (now.getHours() >= 5 && now.getHours() < 7) ? "íœ´ì¥" : "ìš´ì˜";
                                statusClass = statusText === 'ìš´ì˜' ? 'bg-green-100 text-green-600' : 'bg-gray-100 text-gray-500';
                            } else if (timer.type === 'schedule') {
                                const res = calculateSchedule(timer.schedules, now);
                                statusText = res.statusText + " (" + res.timeStr + ")";
                                statusClass = res.isRunning ? 'bg-green-100 text-green-600' : 'bg-gray-100 text-gray-500';
                            } else if (timer.type === 'event') {
                                statusText = "ì§„í–‰ ì¤‘"; statusClass = 'bg-purple-50 text-purple-600';
                            }
                            groupContent += `
                            <div class="mt-3 p-3 bg-white border border-gray-100 rounded-xl flex justify-between items-center shadow-sm">
                                <span class="text-sm font-bold text-gray-700">ğŸš© ${timer.name}</span>
                                <span class="text-xs font-bold px-2 py-1 rounded ${statusClass}">${statusText}</span>
                            </div>`;
                        }
                    });
                    todoHtml += `
                    <div class="bg-white p-5 rounded-2xl border border-gray-200 shadow-sm">
                        <div class="flex justify-between items-end pb-3 border-b border-gray-100 mb-2">
                            <div><h3 class="text-lg font-extrabold text-gray-900 leading-none">${group.title}</h3><p class="text-xs text-gray-400 mt-1">${group.desc}</p></div>
                            <div class="text-xs text-right">${groupTimeStr}</div>
                        </div>
                        ${groupContent}
                    </div>`;
                });
                todoList.innerHTML = todoHtml;
            }
        };
        // ============================================================
        // â˜… ì•„ë˜ ì½”ë“œë¥¼ <script> ë§¨ ë§ˆì§€ë§‰ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.
        // â˜… ë¬´ë¦¼ë¡/ì²œì§€ë¡ ë¦¬ìŠ¤íŠ¸ì˜ ìŠ¤íƒ€ì¼ê³¼ ê°œìˆ˜(PC 10ê°œ/ëª¨ë°”ì¼)ë¥¼ ì œì–´í•©ë‹ˆë‹¤.
        // ============================================================
        // [ìˆ˜ì •] ì²œì§€ë¡ í™ˆ í™”ë©´ ë Œë”ë§ (í´ë¦­ ì´ë²¤íŠ¸ ë²„ê·¸ ìˆ˜ì • + ìŠ¤íƒ€ì¼ ìœ ì§€)
        function renderHomeChunjiOverride() {
            if (typeof chunjiData === 'undefined') return;
            const list = document.getElementById('home-chunji-list');
            if (!list) return;

            list.innerHTML = '';

            // PCëŠ” 10ê°œ, ëª¨ë°”ì¼ì€ 3ê°œ
            const limit = window.innerWidth >= 1024 ? 10 : 3;

            chunjiData.slice(0, limit).forEach(item => {
                // 1. ìš”ì†Œë¥¼ ì§ì ‘ ìƒì„± (div)
                const div = document.createElement('div');
                div.className = "flex items-center justify-between py-3 px-1 cursor-pointer border-b border-gray-50 last:border-none active:bg-gray-50 hover:bg-gray-50 transition-colors";

                // 2. í´ë¦­ ì´ë²¤íŠ¸ ì§ì ‘ ì—°ê²° (ì´ì œ item ê°ì²´ê°€ ì œëŒ€ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤)
                div.onclick = function () {
                    switchTab('chunji');
                    loadChunjiDetail(item);
                };

                // 3. ë‚´ë¶€ HTML êµ¬ì„±
                const typeBadge = item.type ? `<span class="bg-gray-100 text-gray-500 text-[11px] px-1.5 py-0.5 rounded font-medium mr-2 flex-none">[${item.type}]</span>` : '';

                div.innerHTML = `
            <div class="flex items-center overflow-hidden min-w-0">
                ${typeBadge}
                <span class="text-[15px] font-semibold text-gray-800 truncate">${item.title}</span>
            </div>
            <span class="text-gray-300 text-lg flex-none ml-2">â€º</span>
        `;

                // 4. ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
                list.appendChild(div);
            });
        }
        window.renderHomeChunji = renderHomeChunjiOverride;

        // [ìˆ˜ì •] ë¬´ë¦¼ë¡ í™ˆ í™”ë©´ ë Œë”ë§ (í´ë¦­ ì´ë²¤íŠ¸ ì•ˆì „ì„± ê°•í™”)
        function loadMansarokMenu() {
            fetch('json/quests.json').then(r => r.json()).then(data => {
                const list = document.getElementById('mansarok-list');
                if (!list) return;
                list.innerHTML = '';

                const limit = window.innerWidth >= 1024 ? 10 : 5;

                data.filter(i => !['ì§€ê³¼', 'ë³´ìŠ¤ ê³µëµ'].includes(i.type)).slice(0, limit).forEach(item => {
                    // 1. ìš”ì†Œ ìƒì„±
                    const div = document.createElement('div');
                    div.className = "flex items-center justify-between py-3 px-1 cursor-pointer border-b border-gray-50 last:border-none active:bg-gray-50 hover:bg-gray-50 transition-colors";

                    // 2. í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²°
                    div.onclick = function () {
                        switchTab('quest');
                        loadQuestDetail(item.filepath, item.id);
                    };

                    // 3. ë‚´ë¶€ HTML
                    const loc = item.location ? `<span class="bg-gray-100 text-gray-500 text-[11px] px-1.5 py-0.5 rounded font-medium mr-2 flex-none">[${item.location}]</span>` : '';

                    div.innerHTML = `
                <div class="flex items-center overflow-hidden min-w-0">
                    ${loc}
                    <span class="text-[15px] font-semibold text-gray-800 truncate">${item.name}</span>
                </div>
                <span class="text-gray-300 text-lg flex-none ml-2">â€º</span>
            `;

                    list.appendChild(div);
                });
            }).catch(e => console.log(e));
        }

        // ì´ˆê¸° ì‹¤í–‰
        loadMansarokMenu();
        setTimeout(renderHomeChunjiOverride, 500);

        // [3] í˜ì´ì§€ ë¡œë“œ ì‹œ ì¦‰ì‹œ ì‹¤í–‰
        loadMansarokMenu();
        setTimeout(renderHomeChunjiOverride, 500); // ë°ì´í„° ë¡œë”© ì‹œê°„ ê³ ë ¤
        // [6] ê¸°íƒ€ ìœ í‹¸ (ê°€ì´ë“œ, ì œë³´ ë“±)
        window.openGuideDirect = function (url) { if (typeof loadGuideContent === 'function') { loadGuideContent(url); switchTab('guide'); } else { switchTab('guide'); } };
        window.openReportSheet = function () { const sheet = document.getElementById('report-sheet-modal'); sheet.classList.remove('hidden'); setTimeout(() => sheet.children[1].classList.remove('translate-y-full'), 10); };
        window.closeReportSheet = function () { const sheet = document.getElementById('report-sheet-modal'); sheet.children[1].classList.add('translate-y-full'); setTimeout(() => sheet.classList.add('hidden'), 300); };

        // [7] ì´ˆê¸°í™” ì‹¤í–‰
        setInterval(updateTimers, 1000);
        window.addEventListener('DOMContentLoaded', () => {
            updateTimers();
            if (typeof loadMansarokMenu === 'function') loadMansarokMenu();
            if (typeof renderHomeChunjiOverride === 'function') setTimeout(renderHomeChunjiOverride, 500);
        });

        // [ìµœì¢…] ê¸°ë³¸ ê°€ì´ë“œ ì¸ë””ì¼€ì´í„° ì—°ë™ ìŠ¤í¬ë¦½íŠ¸
        (function () {
            function initGuideScroll() {
                const wrapper = document.getElementById('guide-scroll-wrapper');
                const indicatorContainer = document.getElementById('guide-indicators');

                if (!wrapper || !indicatorContainer) return;

                const dots = indicatorContainer.querySelectorAll('div');

                // 1. ìŠ¤í¬ë¡¤ ê°ì§€: ì¡°ê¸ˆë§Œ ì˜†ìœ¼ë¡œ ë°€ì–´ë„ ì ì´ ë°”ë€Œê²Œ ì„¤ì •
                wrapper.addEventListener('scroll', () => {
                    // í˜„ì¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ê°€ 30pxë§Œ ë„˜ì–´ê°€ë„ 2í˜ì´ì§€(5~6ë²ˆ ì•„ì´ì½˜)ë¡œ ì¸ì‹
                    const isSecondPage = wrapper.scrollLeft > 30;

                    if (isSecondPage) {
                        // 2ë²ˆì§¸ ì  í™œì„±í™”
                        dots[0].className = "w-1.5 h-1.5 rounded-full bg-gray-200 transition-all duration-300";
                        dots[1].className = "w-4 h-1.5 rounded-full bg-blue-500 transition-all duration-300";
                    } else {
                        // 1ë²ˆì§¸ ì  í™œì„±í™”
                        dots[0].className = "w-4 h-1.5 rounded-full bg-blue-500 transition-all duration-300";
                        dots[1].className = "w-1.5 h-1.5 rounded-full bg-gray-200 transition-all duration-300";
                    }
                }, { passive: true });

                // 2. ì¸ë””ì¼€ì´í„° í´ë¦­ ì‹œ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™
                dots.forEach((dot, idx) => {
                    dot.style.cursor = 'pointer';
                    dot.onclick = () => {
                        // ì²« ë²ˆì§¸ ì ì€ ë§¨ ì•ìœ¼ë¡œ, ë‘ ë²ˆì§¸ ì ì€ ë§¨ ë’¤ë¡œ ìŠ¤í¬ë¡¤
                        const targetX = idx === 0 ? 0 : wrapper.scrollWidth;
                        wrapper.scrollTo({ left: targetX, behavior: 'smooth' });
                    };
                });
            }

            // ë¬¸ì„œ ë¡œë“œ ì¦‰ì‹œ ì‹¤í–‰ ë° ëª¨ë°”ì¼ ë Œë”ë§ ì§€ì—° ëŒ€ì‘
            if (document.readyState === 'complete') {
                initGuideScroll();
            } else {
                window.addEventListener('load', initGuideScroll);
            }
            // í˜¹ì‹œ ëª¨ë¥¼ ë¡œë”© ì§€ì—°ì„ ìœ„í•´ 0.5ì´ˆ ë’¤ í•œ ë²ˆ ë” ì‹¤í–‰
            setTimeout(initGuideScroll, 500);
        })();
    </script>
</body>

</html>